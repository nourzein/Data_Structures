{"changed":true,"filter":false,"title":"test.js","tooltip":"/test/test.js","value":"//console.log(\"test\")\nconst { Client } = require('pg');\nconst dotenv = require('dotenv');\ndotenv.config();\nconst handlebars = require('handlebars')\nconst fs = require('fs')\n\n\n//Configure Photon\nvar device_id = process.env.PHOTON_ID;\nvar access_token = process.env.PHOTON_TOKEN;\nvar particle_variable = 'tempsensor';\nvar device_url = 'https://api.particle.io/v1/devices/' + device_id + '/' + particle_variable + '?access_token=' + access_token;\n    \n// AWS RDS POSTGRESQL INSTANCE\nvar db_credentials = new Object();\n    db_credentials.user = 'nour'; //your username\n    db_credentials.host = process.env.WEB_HOST; //your endpoint\n    db_credentials.database = 'aa';\n    db_credentials.password = process.env.POSTGPW; //password. use an environment variable \n    db_credentials.port = 5432; \n\n//DB CONFIG\nvar AWS = require('aws-sdk');\nAWS.config = new AWS.Config();\nAWS.config.region = \"us-east-2\";\nvar dynamodb = new AWS.DynamoDB();    \n\n// //Install Express\nvar express = require('express'), // npm install express\n    app = express();\n\napp.get('/sensor', function(req, res1) {\n    var templateVariables= { title: 'My Sensor Data', body: 'These are my temperatures in my room'};\n        //res.send('<h3>this is the page for my sensor data</h3>');  \n        \n    // Connect to the AWS RDS Postgres database\n    const client = new Client(db_credentials);\n    client.connect();\n    \n    var thisQuery = \"SELECT * FROM sensorData;\";\n    client.query(thisQuery, (err, res) => {\n        if (err) {throw err}\n        else {\n            \n            fs.readFile('./sensor.html', 'utf8', (error, data) => {\n                var template = handlebars.compile(data)\n                //console.log(templateVariables)\n                templateVariables.temperatures = res.rows;\n                //console.log(templateVariables)\n                var html = template(templateVariables)\n                res1.send(html)\n            // //console.table(res.rows);\n            // var rows= JSON.stringify(res.rows)\n            // res1.send(`<p> Rows ${rows} </p>`); \n            //\n            \n            client.end();\n        });\n         client.end();\n        }\n    });\n\n});\n\napp.get('/aa',  function(req, res1) {\n    //res.send('<h3>this is the page for my sensor data</h3>');  \n    \n    // Connect to the AWS RDS Postgres database\n   var templateVariables= {};\n\n  \n    const client = new Client(db_credentials);\n    client.connect();\n    \n    var thisQuery = \"SELECT * FROM aaallmeetings;\";\n    client.query(thisQuery,   (err, res) => {\n        if (err) {throw err}\n        else {\n            \n            const data = res.rows;\n            \n            // start leaflet js\n\n            \n            \n            \n            \n            \n            \n            \n            \n            \n            \n            fs.readFile('./aa.hbs', 'utf8', (error, myData) => {\n                var template = handlebars.compile(myData, data)\n                // console.log(templateVariables)\n                templateVariables.blockofMeetings = data;\n                templateVariables.myData = JSON.stringify(data);\n                //console.log(templateVariables)\n                var html = template(templateVariables)\n                res1.send(html)\n            })\n\n        }\n        client.end();\n    });\n});\n\n\n\n\n\n//dear_diary query\napp.get('/processBlog', function(req, res1) {\n    \n var templateVariables= {};\n \n    var params = {\n        TableName : \"Dear_Diary\",\n        KeyConditionExpression: \n        \"#tp = :topicName and dt between :minDate and :maxDate\", // the query expression\n        ExpressionAttributeNames: { // name substitution, used for reserved words in DynamoDB\n            \"#tp\" : \"topic\"\n        },\n        ExpressionAttributeValues: { // the query values\n            \":topicName\": { S: \"Data Structures Homework\"},\n            \":minDate\": {S: new Date(\"September 26, 2019\").toLocaleString()},\n            \":maxDate\": {S: new Date(\"September 28, 2019\").toLocaleString()}\n        }\n    };\n    \n    \n    dynamodb.query(params, function(err, data2) {\n      if (err) {\n        console.error(\"Unable to query. Error:\", JSON.stringify(err, null, 2));\n      } else {\n             \n             fs.readFile('./pblog.html', 'utf8', (error, data) => {\n                var template = handlebars.compile(data)\n                //console.log(templateVariables)\n                templateVariables.blogPost = data2.Items\n                console.log(templateVariables)\n                var html = template(templateVariables)\n                res1.send(html)\n            })\n         \n        // console.log(\"Query succeeded.\");\n        // res1.send(JSON.stringify(data.Items, null, 4));\n        // .forEach(function(item) {\n        //   console.log(\"***** ***** ***** ***** ***** \\n\", item);\n        // });\n      }\n    });\n\n});\n\n// serve static files in /public\napp.use(express.static('public'));\n\n// listen on port 8080\napp.listen(8080, function() {\n    console.log('Server listening...');\n});","undoManager":{"mark":-2,"position":38,"stack":[[{"start":{"row":75,"column":48},"end":{"row":75,"column":49},"action":"insert","lines":[" "],"id":2},{"start":{"row":75,"column":49},"end":{"row":75,"column":50},"action":"insert","lines":["E"]}],[{"start":{"row":75,"column":49},"end":{"row":75,"column":50},"action":"remove","lines":["E"],"id":3}],[{"start":{"row":75,"column":49},"end":{"row":75,"column":50},"action":"insert","lines":["W"],"id":4},{"start":{"row":75,"column":50},"end":{"row":75,"column":51},"action":"insert","lines":["H"]},{"start":{"row":75,"column":51},"end":{"row":75,"column":52},"action":"insert","lines":["E"]},{"start":{"row":75,"column":52},"end":{"row":75,"column":53},"action":"insert","lines":["R"]},{"start":{"row":75,"column":53},"end":{"row":75,"column":54},"action":"insert","lines":["E"]}],[{"start":{"row":75,"column":54},"end":{"row":75,"column":55},"action":"insert","lines":[" "],"id":5},{"start":{"row":75,"column":55},"end":{"row":75,"column":56},"action":"insert","lines":["d"]},{"start":{"row":75,"column":56},"end":{"row":75,"column":57},"action":"insert","lines":["a"]},{"start":{"row":75,"column":57},"end":{"row":75,"column":58},"action":"insert","lines":["y"]}],[{"start":{"row":75,"column":58},"end":{"row":75,"column":59},"action":"insert","lines":[" "],"id":6}],[{"start":{"row":75,"column":58},"end":{"row":75,"column":59},"action":"remove","lines":[" "],"id":7}],[{"start":{"row":75,"column":58},"end":{"row":75,"column":59},"action":"insert","lines":["-"],"id":8}],[{"start":{"row":75,"column":59},"end":{"row":75,"column":60},"action":"insert","lines":[" "],"id":9}],[{"start":{"row":75,"column":59},"end":{"row":75,"column":60},"action":"remove","lines":[" "],"id":10},{"start":{"row":75,"column":58},"end":{"row":75,"column":59},"action":"remove","lines":["-"]}],[{"start":{"row":75,"column":58},"end":{"row":75,"column":59},"action":"insert","lines":["="],"id":11}],[{"start":{"row":75,"column":59},"end":{"row":75,"column":60},"action":"insert","lines":[" "],"id":12},{"start":{"row":75,"column":60},"end":{"row":75,"column":61},"action":"insert","lines":["M"]},{"start":{"row":75,"column":61},"end":{"row":75,"column":62},"action":"insert","lines":["o"]},{"start":{"row":75,"column":62},"end":{"row":75,"column":63},"action":"insert","lines":["n"]},{"start":{"row":75,"column":63},"end":{"row":75,"column":64},"action":"insert","lines":["d"]},{"start":{"row":75,"column":64},"end":{"row":75,"column":65},"action":"insert","lines":["a"]},{"start":{"row":75,"column":65},"end":{"row":75,"column":66},"action":"insert","lines":["y"]},{"start":{"row":75,"column":66},"end":{"row":75,"column":67},"action":"insert","lines":["s"]}],[{"start":{"row":74,"column":4},"end":{"row":75,"column":0},"action":"insert","lines":["",""],"id":13},{"start":{"row":75,"column":0},"end":{"row":75,"column":4},"action":"insert","lines":["    "]},{"start":{"row":75,"column":4},"end":{"row":75,"column":5},"action":"insert","lines":["v"]}],[{"start":{"row":75,"column":5},"end":{"row":75,"column":6},"action":"insert","lines":["a"],"id":14},{"start":{"row":75,"column":6},"end":{"row":75,"column":7},"action":"insert","lines":["r"]}],[{"start":{"row":75,"column":7},"end":{"row":75,"column":8},"action":"insert","lines":[" "],"id":15},{"start":{"row":75,"column":8},"end":{"row":75,"column":9},"action":"insert","lines":["q"]},{"start":{"row":75,"column":9},"end":{"row":75,"column":10},"action":"insert","lines":["u"]},{"start":{"row":75,"column":10},"end":{"row":75,"column":11},"action":"insert","lines":["e"]},{"start":{"row":75,"column":11},"end":{"row":75,"column":12},"action":"insert","lines":["r"]},{"start":{"row":75,"column":12},"end":{"row":75,"column":13},"action":"insert","lines":["y"]}],[{"start":{"row":75,"column":13},"end":{"row":75,"column":14},"action":"insert","lines":[" "],"id":16}],[{"start":{"row":75,"column":13},"end":{"row":75,"column":14},"action":"remove","lines":[" "],"id":17}],[{"start":{"row":75,"column":13},"end":{"row":75,"column":14},"action":"insert","lines":["D"],"id":18},{"start":{"row":75,"column":14},"end":{"row":75,"column":15},"action":"insert","lines":["a"]},{"start":{"row":75,"column":15},"end":{"row":75,"column":16},"action":"insert","lines":["y"]},{"start":{"row":75,"column":16},"end":{"row":75,"column":17},"action":"insert","lines":["="]}],[{"start":{"row":75,"column":17},"end":{"row":75,"column":18},"action":"insert","lines":[" "],"id":19},{"start":{"row":75,"column":18},"end":{"row":76,"column":0},"action":"insert","lines":["",""]},{"start":{"row":76,"column":0},"end":{"row":76,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":75,"column":18},"end":{"row":75,"column":19},"action":"insert","lines":["M"],"id":20},{"start":{"row":75,"column":19},"end":{"row":75,"column":20},"action":"insert","lines":["p"]},{"start":{"row":75,"column":20},"end":{"row":75,"column":21},"action":"insert","lines":["n"]},{"start":{"row":75,"column":21},"end":{"row":75,"column":22},"action":"insert","lines":["d"]},{"start":{"row":75,"column":22},"end":{"row":75,"column":23},"action":"insert","lines":["a"]},{"start":{"row":75,"column":23},"end":{"row":75,"column":24},"action":"insert","lines":["y"]},{"start":{"row":75,"column":24},"end":{"row":75,"column":25},"action":"insert","lines":["s"]}],[{"start":{"row":75,"column":24},"end":{"row":75,"column":25},"action":"remove","lines":["s"],"id":21},{"start":{"row":75,"column":23},"end":{"row":75,"column":24},"action":"remove","lines":["y"]},{"start":{"row":75,"column":22},"end":{"row":75,"column":23},"action":"remove","lines":["a"]},{"start":{"row":75,"column":21},"end":{"row":75,"column":22},"action":"remove","lines":["d"]},{"start":{"row":75,"column":20},"end":{"row":75,"column":21},"action":"remove","lines":["n"]},{"start":{"row":75,"column":19},"end":{"row":75,"column":20},"action":"remove","lines":["p"]},{"start":{"row":75,"column":18},"end":{"row":75,"column":19},"action":"remove","lines":["M"]},{"start":{"row":75,"column":17},"end":{"row":75,"column":18},"action":"remove","lines":[" "]}],[{"start":{"row":75,"column":17},"end":{"row":75,"column":18},"action":"insert","lines":[" "],"id":22}],[{"start":{"row":75,"column":18},"end":{"row":75,"column":20},"action":"insert","lines":["\"\""],"id":23}],[{"start":{"row":75,"column":19},"end":{"row":75,"column":20},"action":"insert","lines":["M"],"id":24},{"start":{"row":75,"column":20},"end":{"row":75,"column":21},"action":"insert","lines":["o"]},{"start":{"row":75,"column":21},"end":{"row":75,"column":22},"action":"insert","lines":["n"]},{"start":{"row":75,"column":22},"end":{"row":75,"column":23},"action":"insert","lines":["d"]},{"start":{"row":75,"column":23},"end":{"row":75,"column":24},"action":"insert","lines":["a"]},{"start":{"row":75,"column":24},"end":{"row":75,"column":25},"action":"insert","lines":["y"]},{"start":{"row":75,"column":25},"end":{"row":75,"column":26},"action":"insert","lines":["s"]}],[{"start":{"row":77,"column":60},"end":{"row":77,"column":67},"action":"remove","lines":["Mondays"],"id":25}],[{"start":{"row":77,"column":60},"end":{"row":77,"column":61},"action":"insert","lines":["\""],"id":26}],[{"start":{"row":77,"column":61},"end":{"row":77,"column":62},"action":"insert","lines":["+"],"id":27}],[{"start":{"row":77,"column":62},"end":{"row":77,"column":63},"action":"insert","lines":[" "],"id":28}],[{"start":{"row":77,"column":63},"end":{"row":77,"column":64},"action":"insert","lines":["q"],"id":29},{"start":{"row":77,"column":64},"end":{"row":77,"column":65},"action":"insert","lines":["u"]},{"start":{"row":77,"column":65},"end":{"row":77,"column":66},"action":"insert","lines":["e"]},{"start":{"row":77,"column":66},"end":{"row":77,"column":67},"action":"insert","lines":["r"]},{"start":{"row":77,"column":67},"end":{"row":77,"column":68},"action":"insert","lines":["y"]},{"start":{"row":77,"column":68},"end":{"row":77,"column":69},"action":"insert","lines":["D"]},{"start":{"row":77,"column":69},"end":{"row":77,"column":70},"action":"insert","lines":["a"]}],[{"start":{"row":77,"column":70},"end":{"row":77,"column":71},"action":"insert","lines":["y"],"id":30},{"start":{"row":77,"column":71},"end":{"row":77,"column":72},"action":"insert","lines":["\""]}],[{"start":{"row":77,"column":60},"end":{"row":77,"column":61},"action":"remove","lines":["\""],"id":31}],[{"start":{"row":77,"column":61},"end":{"row":77,"column":62},"action":"insert","lines":["\""],"id":32}],[{"start":{"row":77,"column":62},"end":{"row":77,"column":63},"action":"remove","lines":[" "],"id":33}],[{"start":{"row":77,"column":61},"end":{"row":77,"column":62},"action":"insert","lines":[" "],"id":34}],[{"start":{"row":77,"column":59},"end":{"row":77,"column":60},"action":"insert","lines":["\""],"id":35}],[{"start":{"row":77,"column":72},"end":{"row":77,"column":73},"action":"remove","lines":["\""],"id":36}],[{"start":{"row":77,"column":63},"end":{"row":77,"column":64},"action":"remove","lines":["\""],"id":37}],[{"start":{"row":77,"column":71},"end":{"row":77,"column":72},"action":"insert","lines":[" "],"id":38},{"start":{"row":77,"column":72},"end":{"row":77,"column":73},"action":"insert","lines":["+"]}],[{"start":{"row":77,"column":73},"end":{"row":77,"column":75},"action":"insert","lines":["\"\""],"id":39}],[{"start":{"row":77,"column":74},"end":{"row":77,"column":75},"action":"remove","lines":["\""],"id":40}]]},"ace":{"folds":[],"scrolltop":802,"scrollleft":0,"selection":{"start":{"row":77,"column":59},"end":{"row":77,"column":74},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":51,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1574463010257}